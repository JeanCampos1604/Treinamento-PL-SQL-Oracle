CREATE TABLE DAILYSALES
(
    DATE_ID DATE,
    MAKE_NAME VARCHAR(20),
    LEAD_ID INTEGER,
    PARTNER_ID INTEGER
);


INSERT INTO DAILYSALES VALUES ('08/12/2020','toyota',0,1);

INSERT INTO DAILYSALES VALUES ('08/12/2020','toyota',1,0);

INSERT INTO DAILYSALES VALUES ('08/12/2020','toyota',1,2);

INSERT INTO DAILYSALES VALUES ('07/12/2020','toyota',0,2);

INSERT INTO DAILYSALES VALUES ('07/12/2020','toyota',0,1);

INSERT INTO DAILYSALES VALUES ('08/12/2020','honda',1,2);

INSERT INTO DAILYSALES VALUES ('08/12/2020','honda',2,1);

INSERT INTO DAILYSALES VALUES ('07/12/2020','honda',0,1);

INSERT INTO DAILYSALES VALUES ('07/12/2020','honda',1,2);

INSERT INTO DAILYSALES VALUES ('07/12/2020','honda',2,1);

SELECT * FROM DAILYSALES;

SELECT DISTINCT TO_CHAR(DATE_ID,'yyyy-mm-dd')"date_id", 
       MAKE_NAME "make_name",
       COUNT(DISTINCT LEAD_ID) "unique_leads", 
       COUNT(DISTINCT PARTNER_ID) "unique_partners"
  FROM DAILYSALES
  GROUP BY DATE_ID, MAKE_NAME
  ORDER BY 2 DESC;
  
